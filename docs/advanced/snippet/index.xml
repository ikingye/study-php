<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>2.4 代码片段 on PHP 学习笔记</title><link>https://kingye.me/study-php/docs/advanced/snippet/</link><description>Recent content in 2.4 代码片段 on PHP 学习笔记</description><generator>Hugo</generator><language>en</language><atom:link href="https://kingye.me/study-php/docs/advanced/snippet/index.xml" rel="self" type="application/rss+xml"/><item><title>Markdown 文件生成 TOC</title><link>https://kingye.me/study-php/docs/advanced/snippet/simple-php-github-toc/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://kingye.me/study-php/docs/advanced/snippet/simple-php-github-toc/</guid><description>&lt;h1 id="生成-github-readme-文件-toc-目录-的简单脚本">
 生成 Github Readme 文件 TOC 目录 的简单脚本
 &lt;a class="anchor" href="#%e7%94%9f%e6%88%90-github-readme-%e6%96%87%e4%bb%b6-toc-%e7%9b%ae%e5%bd%95-%e7%9a%84%e7%ae%80%e5%8d%95%e8%84%9a%e6%9c%ac">#&lt;/a>
&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#a6e22e">php&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">/**
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> * site: https://github.com/xingshaocheng/simple-php-github-toc
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">count&lt;/span>($argv) &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">exit&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Please input github file url, eg &amp;#39;php github-toc.php https://github.com/xingshaocheng/architect-awesome/blob/master/README.md&amp;#39;.&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$url &lt;span style="color:#f92672">=&lt;/span> $argv[&lt;span style="color:#ae81ff">1&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#$url = &amp;#34;https://github.com/xingshaocheng/architect-awesome/blob/master/README.md&amp;#34;;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">get_anchor&lt;/span>($content){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">preg_match_all&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/href=&lt;/span>&lt;span style="color:#ae81ff">\&amp;#34;&lt;/span>&lt;span style="color:#e6db74">(.*)&lt;/span>&lt;span style="color:#ae81ff">\&amp;#34;&lt;/span>&lt;span style="color:#e6db74">&amp;gt;/iUs&amp;#34;&lt;/span>, $content, $anchor_arr);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">count&lt;/span>($anchor_arr) &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> $anchor_arr[&lt;span style="color:#ae81ff">1&lt;/span>][&lt;span style="color:#ae81ff">0&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">get_title&lt;/span>($content){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">preg_match_all&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/a\&amp;gt;(.*)$/iUs&amp;#34;&lt;/span>, $content, $title_arr);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">count&lt;/span>($title_arr) &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">trim&lt;/span>($title_arr[&lt;span style="color:#ae81ff">1&lt;/span>][&lt;span style="color:#ae81ff">0&lt;/span>]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$content &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">file_get_contents&lt;/span>($url);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">preg_match_all&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/&amp;lt;article(.*)&amp;lt;\/article&amp;gt;/iUs&amp;#34;&lt;/span>, $content, $article);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$article_html &lt;span style="color:#f92672">=&lt;/span> $article[&lt;span style="color:#ae81ff">0&lt;/span>][&lt;span style="color:#ae81ff">0&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">preg_match_all&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/&amp;lt;h([1-6])&amp;gt;(.*)&amp;lt;\/h[1-6]{1}&amp;gt;/iUs&amp;#34;&lt;/span>, $article_html, $each_head);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$len &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">count&lt;/span>($each_head[&lt;span style="color:#ae81ff">0&lt;/span>]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span>($i &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;$i &lt;span style="color:#f92672">&amp;lt;&lt;/span> $len; $i&lt;span style="color:#f92672">++&lt;/span>){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $level &lt;span style="color:#f92672">=&lt;/span> $each_head[&lt;span style="color:#ae81ff">1&lt;/span>][$i];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $each_content &lt;span style="color:#f92672">=&lt;/span> $each_head[&lt;span style="color:#ae81ff">2&lt;/span>][$i];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $anchor &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">get_anchor&lt;/span>($each_content);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $title &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">get_title&lt;/span>($each_content);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#a6e22e">str_repeat&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\t&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>,($level&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>)),&lt;span style="color:#e6db74">&amp;#34;* &amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;[&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>title}](${url}${anchor&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">)&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74"> TOC generated by [simple-php-github-toc](https://github.com/xingshaocheng/simple-php-github-toc) &lt;/span>&lt;span style="color:#ae81ff">\n\n&lt;/span>&lt;span style="color:#e6db74"> &amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="参考">
 参考
 &lt;a class="anchor" href="#%e5%8f%82%e8%80%83">#&lt;/a>
&lt;/h2>
&lt;h3 id="xingshaochengsimple-php-github-tochttpsgithubcomxingshaochengsimple-php-github-toc-github-starshttpsimgshieldsiogithubstarsxingshaochengsimple-php-github-tocsvg">
 &lt;a href="https://github.com/xingshaocheng/simple-php-github-toc">xingshaocheng/simple-php-github-toc&lt;/a> &lt;img src="https://img.shields.io/github/stars/xingshaocheng/simple-php-github-toc.svg" alt="Github stars" />
 &lt;a class="anchor" href="#xingshaochengsimple-php-github-tochttpsgithubcomxingshaochengsimple-php-github-toc-github-starshttpsimgshieldsiogithubstarsxingshaochengsimple-php-github-tocsvg">#&lt;/a>
&lt;/h3></description></item></channel></rss>